# 团队角色显示和权限优化

## 更新时间
2026-01-27

## 更新内容

### 1. TeamDetailScreen.js - 修复普通成员按钮遮挡问题

**问题：** 普通成员的"发起活动"和"申请管理员"按钮遮挡了页面标题

**解决方案：** 将普通成员的操作按钮改为下拉菜单（三点图标）

**修改后的显示：**
- **管理员视图：** 三个独立图标按钮（邀请、发起活动、发布公告）
- **普通成员视图：** 一个三点菜单按钮，点击后弹出操作选项
  - 发起活动
  - 申请管理员（已申请后显示为"已申请管理员"）
  - 取消

### 2. QuestionTeamsScreen.js - 添加角色显示

**新增功能：** 在问题团队列表中显示用户在每个团队的角色

**显示内容：**
```
我的角色：[管理员] 或 [成员]
```

**角色标识样式：**
- **管理员：** 红色背景，红色边框，红色文字
- **成员：** 灰色背景，灰色文字
- **未加入：** 不显示角色信息

**数据配置：**
```javascript
团队1: { role: '管理员', isAdmin: true, isJoined: true }
团队2: { role: '未加入', isAdmin: false, isJoined: false }
团队3: { role: '成员', isAdmin: false, isJoined: true }
团队4: { role: '未加入', isAdmin: false, isJoined: false }
```

## 测试路径

### 测试1：普通成员按钮不遮挡标题
1. 问题详情页 → 团队按钮 → 点击"代码审查小组"（成员角色）
2. 查看页面标题是否清晰可见
3. 点击右上角三点菜单
4. 验证弹出菜单包含：发起活动、申请管理员、取消

### 测试2：问题团队列表显示角色
1. 问题详情页 → 点击团队按钮
2. 查看团队列表
3. 验证每个已加入的团队下方显示"我的角色"信息
4. 验证角色标识样式正确（管理员红色，成员灰色）

### 测试3：角色权限跳转
1. 问题详情页 → 团队按钮
2. 点击"Python学习互助团"（管理员角色）
3. 验证详情页显示：邀请、发起活动、发布公告三个按钮
4. 返回，点击"代码审查小组"（成员角色）
5. 验证详情页显示：三点菜单按钮

## 视觉效果

### 团队详情页头部（普通成员）
```
[←]        团队详情页        [⋯]
```

### 问题团队列表（角色显示）
```
Python学习互助团                    [✓ 已加入]
一起学习Python，互相帮助解决问题
👤 我的角色：[管理员]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
156人 | 张三丰 | ● 活跃              [进入 →]

代码审查小组                        [✓ 已加入]
互相审查代码，提升编程能力
👤 我的角色：[成员]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
234人 | 王医生 | ● 非常活跃          [进入 →]
```

## 技术细节

### 下拉菜单实现
使用 `Alert.alert()` 实现操作菜单：
- 标题：团队操作
- 选项：发起活动、申请管理员、取消
- 已申请管理员后，该选项变为不可点击状态

### 角色显示逻辑
```javascript
{team.isJoined && (
  <View style={styles.userRoleRow}>
    <Ionicons name="person-circle-outline" size={14} color="#6b7280" />
    <Text style={styles.userRoleText}>我的角色：</Text>
    <View style={[styles.roleBadge, team.isAdmin && styles.roleBadgeAdmin]}>
      <Text style={[styles.roleBadgeText, team.isAdmin && styles.roleBadgeTextAdmin]}>
        {team.role}
      </Text>
    </View>
  </View>
)}
```

## 状态
✅ 所有功能已实现并优化完成
