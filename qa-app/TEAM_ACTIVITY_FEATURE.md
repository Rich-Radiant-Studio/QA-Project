# 团队活动发起功能完成

## ✅ 功能概述

实现了团队发起活动的功能，用户可以选择以个人身份或团队身份发起活动，活动列表会显示发起者信息。

## 📋 实现内容

### 1. 团队详情页新增"发起活动"按钮 🎯

**位置**: 团队详情页头部右侧

**功能**: 
- 点击后跳转到活动页面，并自动打开发起活动弹窗
- 默认选择"团队发起"身份
- 传递团队ID和团队名称

**实现代码**:
```javascript
<TouchableOpacity 
  style={styles.publishBtn}
  onPress={() => navigation.navigate('Activity', { 
    createMode: true, 
    teamId: team.id, 
    teamName: team.name 
  })}
>
  <Ionicons name="calendar" size={18} color="#3b82f6" />
  <Text style={[styles.publishBtnText, { color: '#3b82f6' }]}>发起活动</Text>
</TouchableOpacity>
```

### 2. 活动发起身份选择 👥

**选项**:
- **个人发起**: 以个人名义发起活动
- **团队发起**: 以团队名义发起活动（显示团队名称）

**样式**:
```
┌─────────────────────────────────┐
│ 发起身份 *                       │
├─────────────────────────────────┤
│ [👤 个人发起] [👥 团队发起]      │
└─────────────────────────────────┘
```

**逻辑**:
- 从团队页面进入：默认选择"团队发起"
- 从其他入口进入：默认选择"个人发起"
- 可以手动切换发起身份

### 3. 活动列表显示发起者信息 📊

**显示内容**:
- 发起者名称（个人名/团队名/官方）
- 发起者类型图标
- 发起者类型颜色

**发起者类型**:
| 类型 | 图标 | 颜色 | 示例 |
|------|------|------|------|
| 个人 | person | #3b82f6 (蓝色) | 张三 |
| 团队 | people | #8b5cf6 (紫色) | Python学习互助团队 |
| 官方 | shield-checkmark | #f59e0b (橙色) | 官方 |

**显示位置**:
```
┌─────────────────────────────────┐
│ 活动标题                         │
│ 活动描述...                      │
├─────────────────────────────────┤
│ 👥 Python学习互助团队            │ ← 发起者信息
│ 👥 8956人参与                    │
│ 📅 2026-01-05 ~ 2026-01-26      │
└─────────────────────────────────┘
```

## 🔄 数据结构

### 活动数据新增字段

```javascript
{
  id: 1,
  title: '活动标题',
  desc: '活动描述',
  // ... 其他字段
  
  // 新增字段
  organizerType: 'team',           // 发起者类型: 'personal' | 'team' | 'platform'
  organizer: 'Python学习互助团队',  // 发起者名称
  teamId: 1,                       // 团队ID（仅团队发起时有值）
  teamName: 'Python学习互助团队'   // 团队名称（仅团队发起时有值）
}
```

### 发起活动表单数据

```javascript
{
  title: '',              // 活动标题
  desc: '',               // 活动描述
  type: 'online',         // 活动类型: 'online' | 'offline'
  startTime: '',          // 开始时间
  endTime: '',            // 结束时间
  address: '',            // 活动地址（线下活动）
  image: '',              // 活动封面
  
  // 新增字段
  organizerType: 'personal',  // 发起身份: 'personal' | 'team'
  teamId: null,               // 团队ID
  teamName: ''                // 团队名称
}
```

## 🎨 视觉效果

### 团队详情页头部

```
┌─────────────────────────────────┐
│ ← 团队详情页  [📅发起活动][📢发布公告] │
└─────────────────────────────────┘
```

### 发起活动弹窗

```
┌─────────────────────────────────┐
│ ✕  发起活动                 发布 │
├─────────────────────────────────┤
│ 发起身份 *                       │
│ ┌──────────┐ ┌──────────┐      │
│ │👤 个人发起│ │👥 团队发起│      │
│ └──────────┘ └──────────┘      │
│                                 │
│ 活动类型 *                       │
│ ┌──────────┐ ┌──────────┐      │
│ │🌐 线上活动│ │📍 线下活动│      │
│ └──────────┘ └──────────┘      │
│                                 │
│ 活动标题 *                       │
│ ┌─────────────────────────────┐│
│ │ 请输入活动标题               ││
│ └─────────────────────────────┘│
│                                 │
│ 活动内容 *                       │
│ ┌─────────────────────────────┐│
│ │ 请输入活动详细内容           ││
│ │                             ││
│ └─────────────────────────────┘│
│                                 │
│ ... 其他字段                     │
└─────────────────────────────────┘
```

### 活动卡片

```
┌─────────────────────────────────┐
│ [活动封面图]                     │
│ [热门] [线上]                    │
├─────────────────────────────────┤
│ Python学习打卡活动               │
│ 每日打卡学习Python，坚持21天...  │
│                                 │
│ 👥 Python学习互助团队            │ ← 紫色
│ 👥 8956人参与                    │
│ 📅 2026-01-05 ~ 2026-01-26      │
│                                 │
│ 我的进度：12/21天                │
│ [已参与]                         │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ [活动封面图]                     │
│ [热门] [线下]                    │
├─────────────────────────────────┤
│ 程序员线下交流会                 │
│ 北京站程序员面对面交流...        │
│ 📍 北京市朝阳区望京SOHO          │
│                                 │
│ 👤 张三                          │ ← 蓝色
│ 👥 156人参与                     │
│ 📅 2026-01-25 ~ 2026-01-25      │
│                                 │
│ [立即参与]                       │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ [活动封面图]                     │
│ [热门] [线上]                    │
├─────────────────────────────────┤
│ 新人答题挑战赛                   │
│ 连续7天回答问题，赢取100元...    │
│                                 │
│ 🛡️ 官方                          │ ← 橙色
│ 👥 12580人参与                   │
│ 📅 2026-01-10 ~ 2026-01-20      │
│                                 │
│ [立即参与]                       │
└─────────────────────────────────┘
```

## 🔧 技术实现

### 1. 路由参数传递

**从团队页面跳转到活动页面**:
```javascript
navigation.navigate('Activity', { 
  createMode: true,      // 自动打开发起活动弹窗
  teamId: team.id,       // 团队ID
  teamName: team.name    // 团队名称
});
```

### 2. 发起身份判断

```javascript
// 初始化发起身份
const [newActivity, setNewActivity] = useState({
  // ... 其他字段
  organizerType: teamId ? 'team' : 'personal',  // 如果有teamId，默认选择团队
  teamId: teamId || null,
  teamName: teamName || ''
});
```

### 3. 发起者信息显示

```javascript
// 获取发起者图标
const getOrganizerIcon = (organizerType) => {
  switch (organizerType) {
    case 'team': return 'people';
    case 'personal': return 'person';
    case 'platform': return 'shield-checkmark';
    default: return 'person';
  }
};

// 获取发起者颜色
const getOrganizerColor = (organizerType) => {
  switch (organizerType) {
    case 'team': return '#8b5cf6';      // 紫色
    case 'personal': return '#3b82f6';  // 蓝色
    case 'platform': return '#f59e0b';  // 橙色
    default: return '#6b7280';
  }
};
```

### 4. 活动创建逻辑

```javascript
const handleCreateActivity = () => {
  // ... 验证逻辑
  
  const activity = {
    // ... 其他字段
    organizerType: newActivity.organizerType,
    organizer: newActivity.organizerType === 'team' 
      ? newActivity.teamName   // 团队名称
      : '我'                   // 个人名称
  };
  
  setActivities([activity, ...activities]);
  // ... 清理和提示
};
```

## 📱 用户流程

### 流程1: 团队发起活动

1. 用户进入团队详情页
2. 点击"发起活动"按钮
3. 跳转到活动页面，自动打开发起活动弹窗
4. 默认选择"团队发起"身份（显示团队名称）
5. 填写活动信息
6. 点击"发布"
7. 活动创建成功，显示在活动列表中
8. 活动卡片显示团队名称和紫色图标

### 流程2: 个人发起活动

1. 用户进入活动页面
2. 点击右上角"发起"按钮
3. 打开发起活动弹窗
4. 默认选择"个人发起"身份
5. 可以切换到"团队发起"（如果有团队）
6. 填写活动信息
7. 点击"发布"
8. 活动创建成功，显示在活动列表中
9. 活动卡片显示个人名称和蓝色图标

## 🎯 功能特点

### 1. 灵活的发起身份选择
- 支持个人发起和团队发起
- 从团队页面进入时智能默认团队身份
- 可以随时切换发起身份

### 2. 清晰的发起者标识
- 不同类型使用不同颜色和图标
- 一眼就能看出活动是谁发起的
- 提升活动的可信度和吸引力

### 3. 无缝的用户体验
- 从团队页面一键发起活动
- 自动填充团队信息
- 流程简洁流畅

## 📝 测试要点

### 功能测试
- [x] 团队详情页显示"发起活动"按钮
- [x] 点击"发起活动"跳转到活动页面
- [x] 自动打开发起活动弹窗
- [x] 默认选择"团队发起"身份
- [x] 显示正确的团队名称
- [x] 可以切换到"个人发起"
- [x] 活动创建成功
- [x] 活动列表显示发起者信息
- [x] 发起者图标和颜色正确
- [x] 个人发起显示蓝色图标
- [x] 团队发起显示紫色图标
- [x] 官方发起显示橙色图标

### UI测试
- [x] "发起活动"按钮样式正确
- [x] 发起身份选择器样式正确
- [x] 选中状态高亮明显
- [x] 发起者信息显示清晰
- [x] 颜色区分明显
- [x] 图标大小合适

### 交互测试
- [x] 按钮点击响应及时
- [x] 身份切换流畅
- [x] 弹窗打开关闭正常
- [x] 表单提交正常

## 📄 相关文件

- `qa-app/qa-native-app/src/screens/TeamDetailScreen.js` - 团队详情页（新增发起活动按钮）
- `qa-app/qa-native-app/src/screens/ActivityScreen.js` - 活动页面（新增发起身份选择和显示）
- `qa-app/TEAM_ACTIVITY_FEATURE.md` - 本文档

## 🔄 后续优化建议

1. **团队选择器**: 如果用户加入了多个团队，可以添加团队选择器
2. **权限控制**: 只有团队管理员才能以团队名义发起活动
3. **活动审核**: 团队活动需要团队管理员审核
4. **活动统计**: 显示团队发起的活动数量
5. **活动推荐**: 优先推荐用户所在团队的活动

---

**实现时间**: 2026-01-27  
**实现内容**: 团队发起活动 + 发起身份选择 + 发起者信息显示  
**状态**: ✅ 已完成
