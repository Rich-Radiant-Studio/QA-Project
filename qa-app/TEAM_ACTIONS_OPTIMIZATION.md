# 团队操作按钮优化完成

## 更新时间
2026-01-27

## 功能概述

### 1. 普通成员操作按钮整合
将"发起活动"、"申请管理员"和"退出团队"三个按钮整合在一起显示。

**位置：** 团队成员区域和Tab标签之间

**按钮布局：**
```
┌──────────────┬──────────────┬──────────────┐
│ 📅 发起活动   │ 🛡️ 申请管理员 │ 🚪 退出团队   │
└──────────────┴──────────────┴──────────────┘
```

**按钮样式：**
- **发起活动**：蓝色背景 + 蓝色边框
- **申请管理员**：紫色背景 + 紫色边框（已申请后变灰色）
- **退出团队**：红色背景 + 红色边框

### 2. 管理员解散团队功能
将管理员的"退出"按钮改为"解散团队"，点击后弹出确认弹窗。

**位置：** 团队成员区域和Tab标签之间

**按钮样式：**
```
┌──────────────────────────────────┐
│      🗑️ 解散团队                  │
└──────────────────────────────────┘
```

**解散团队弹窗内容：**
1. **警告图标**：红色警告图标
2. **标题**：解散团队
3. **副标题**：此操作不可恢复，请谨慎操作
4. **警告信息框**：
   - 团队所有数据将被永久删除
   - 所有成员将被移出团队
   - 团队讨论记录将无法恢复
   - 团队公告将全部删除
5. **确认输入**：要求输入团队名称以确认
6. **操作按钮**：取消、确认解散

## 视觉效果

### 普通成员详情页
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
团队信息卡片
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
团队成员区域
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┌──────────┬──────────┬──────────┐
│📅发起活动 │🛡️申请管理员│🚪退出团队 │
└──────────┴──────────┴──────────┘
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[团队讨论] [团队公告]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 管理员详情页
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
团队信息卡片
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
团队成员区域
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┌────────────────────────────────┐
│         🗑️ 解散团队              │
└────────────────────────────────┘
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[团队讨论] [团队公告] [审批消息 3]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 解散团队弹窗
```
┌────────────────────────────────┐
│                                │
│          ⚠️                     │
│                                │
│        解散团队                 │
│   此操作不可恢复，请谨慎操作     │
│                                │
│  ⚠️ 解散后将发生以下情况：       │
│  • 团队所有数据将被永久删除      │
│  • 所有成员将被移出团队          │
│  • 团队讨论记录将无法恢复        │
│  • 团队公告将全部删除            │
│                                │
│  请输入团队名称 "Python学习互助  │
│  团队" 以确认解散               │
│  ┌──────────────────────────┐  │
│  │ [请输入团队名称]          │  │
│  └──────────────────────────┘  │
│                                │
│  [取消]        [🗑️ 确认解散]   │
└────────────────────────────────┘
```

## 交互逻辑

### 普通成员操作

#### 1. 发起活动
- 点击后跳转到活动页面
- 自动传递团队ID和团队名称
- 进入创建活动模式

#### 2. 申请管理员
- 点击后弹出申请弹窗
- 填写申请理由（必填）
- 提交后按钮文字变为"已申请"
- 按钮变灰色且不可点击

#### 3. 退出团队
- 点击后弹出系统确认对话框
- 标题："退出团队"
- 内容："确定要退出该团队吗？退出后将无法查看团队消息"
- 按钮：取消、确定退出
- 确认后显示成功提示并返回上一页

### 管理员操作

#### 解散团队
1. **点击解散团队按钮**
   - 弹出解散团队确认弹窗
   - 显示警告图标和警告信息

2. **输入团队名称确认**
   - 必须完全匹配团队名称
   - 输入错误时"确认解散"按钮为灰色不可点击
   - 输入正确后按钮变为红色可点击

3. **确认解散**
   - 点击"确认解散"按钮
   - 验证输入的团队名称
   - 名称不匹配：提示"团队名称输入不正确"
   - 名称匹配：显示"团队已解散"提示并返回上一页

4. **取消操作**
   - 点击"取消"按钮
   - 关闭弹窗
   - 清空输入的团队名称

## 数据结构

### 解散团队状态
```javascript
const [showDismissModal, setShowDismissModal] = useState(false);
const [dismissConfirmText, setDismissConfirmText] = useState('');
```

### 解散确认逻辑
```javascript
const handleConfirmDismiss = () => {
  if (dismissConfirmText !== team.name) {
    Alert.alert('提示', '团队名称输入不正确');
    return;
  }
  Alert.alert('成功', '团队已解散');
  setShowDismissModal(false);
  setDismissConfirmText('');
  navigation.goBack();
};
```

## 安全机制

### 解散团队二次确认
1. **弹窗警告**：显示详细的后果说明
2. **输入验证**：必须输入完整的团队名称
3. **按钮禁用**：输入不匹配时禁用确认按钮
4. **不可恢复提示**：明确告知操作不可恢复

### 退出团队确认
1. **系统对话框**：使用原生Alert确认
2. **后果说明**：提示退出后无法查看团队消息
3. **取消选项**：提供取消按钮避免误操作

## 样式规范

### 按钮尺寸
- **普通成员按钮**：三个按钮等宽，gap: 8px
- **管理员按钮**：全宽显示
- **按钮高度**：paddingVertical: 12px
- **圆角**：borderRadius: 12px

### 颜色方案
- **发起活动**：#eff6ff (背景) + #bfdbfe (边框) + #3b82f6 (文字)
- **申请管理员**：#f5f3ff (背景) + #ddd6fe (边框) + #8b5cf6 (文字)
- **退出团队**：#fef2f2 (背景) + #fecaca (边框) + #ef4444 (文字)
- **解散团队**：#fef2f2 (背景) + #fecaca (边框) + #ef4444 (文字)
- **已申请状态**：#f3f4f6 (背景) + #e5e7eb (边框) + #9ca3af (文字)

### 图标
- 发起活动：calendar (日历)
- 申请管理员：shield-checkmark-outline (盾牌)
- 退出团队：exit-outline (退出)
- 解散团队：trash-outline (垃圾桶)
- 警告图标：warning (警告)

## 测试路径

### 测试1：普通成员三个按钮
1. 问题详情页 → 团队 → 点击"代码审查小组"（成员角色）
2. 验证显示三个按钮：发起活动、申请管理员、退出团队
3. 点击"发起活动"，验证跳转到活动页面
4. 返回，点击"申请管理员"，验证弹出申请弹窗
5. 提交申请，验证按钮变为"已申请"且不可点击
6. 点击"退出团队"，验证弹出确认对话框

### 测试2：管理员解散团队
1. 首页 → 团队 → 点击"Python学习互助团"（管理员角色）
2. 验证显示"解散团队"按钮
3. 点击"解散团队"，验证弹出解散确认弹窗
4. 验证显示警告信息和输入框
5. 输入错误的团队名称，验证"确认解散"按钮为灰色
6. 输入正确的团队名称，验证"确认解散"按钮变为红色
7. 点击"确认解散"，验证显示成功提示并返回

### 测试3：取消操作
1. 普通成员页面点击"退出团队"
2. 在确认对话框中点击"取消"
3. 验证对话框关闭，页面无变化
4. 管理员页面点击"解散团队"
5. 在弹窗中点击"取消"
6. 验证弹窗关闭，输入框内容被清空

## 状态
✅ 所有功能已实现并测试通过
