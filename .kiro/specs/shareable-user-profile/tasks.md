# 实施计划: 可分享用户主页

## 概述

本实施计划将可分享用户主页功能分解为离散的编码步骤。该功能将创建一个新的PublicProfileScreen组件，用于展示任何用户的公开信息，支持分享、关注、私信等交互功能。

## 任务

- [x] 1. 创建基础组件结构和数据模型
  - 创建PublicProfileScreen.js文件
  - 定义用户数据和内容数据的接口类型（使用JSDoc注释）
  - 设置基本的组件结构和状态管理
  - _需求: 1.1, 1.3_

- [ ] 2. 实现用户信息头部区域（今日头条风格）
  - [x] 2.1 实现ProfileHeader组件
    - 实现左右分栏布局（左侧用户信息，右侧头像）
    - 左侧：用户名在左上方，认证标识紧随其后
    - 左侧：显示统计数据行（关注数、粉丝数、获赞数）
    - 右侧：显示圆形头像，带认证角标
    - 显示认证信息文字（如"联合国军事观察员 军事学博士"）
    - 显示用户标签（最多显示3个，超过显示"..."）
    - 显示地区、性别、MCN等元信息
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 13.1, 13.2, 13.3, 14.1, 14.2, 14.3, 15.1, 15.2_

  - [ ]* 2.2 编写ProfileHeader的属性测试
    - **属性 2: 用户信息完整性渲染**
    - **验证需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 8.3, 8.4, 13.1, 13.2, 13.3, 14.1, 14.2, 15.1, 15.2**

- [ ] 3. 实现顶部导航栏（今日头条风格）
  - [x] 3.1 创建Header组件
    - 实现返回按钮（左侧）
    - 显示用户简介文字（中间居中显示，过长时截断并显示省略号）
    - 实现更多操作按钮（右侧三个点菜单）
    - 实现分享按钮
    - _需求: 7.1, 8.1, 8.3, 8.4, 8.5_

  - [ ]* 3.2 编写Header组件的单元测试
    - 测试按钮点击事件
    - 测试导航行为
    - 测试简介文字截断逻辑
    - _需求: 8.2, 8.6_

- [ ] 4. 实现操作按钮区域（今日头条风格）
  - [x] 4.1 创建ActionButtons组件
    - 实现关注按钮（红色背景，白色文字，根据关注状态显示不同文本）
    - 实现发私信按钮（白色背景，灰色边框，灰色文字）
    - 两个按钮并排显示，关注按钮更突出
    - 处理未登录状态（跳转到登录页面）
    - 处理查看自己主页时隐藏按钮的逻辑
    - _需求: 3.1, 3.2, 3.6, 3.7, 4.1, 4.3, 4.4_

  - [ ]* 4.2 编写关注功能的属性测试
    - **属性 3: 关注按钮状态一致性**
    - **验证需求: 3.1, 3.2, 3.7**

  - [ ]* 4.3 编写关注操作的属性测试
    - **属性 4: 关注操作状态变更**
    - **验证需求: 3.3, 3.5**

  - [ ]* 4.4 编写未登录状态的单元测试
    - 测试未登录时点击关注按钮跳转到登录页
    - 测试未登录时点击私信按钮跳转到登录页
    - _需求: 3.6, 4.3_

- [x] 5. 检查点 - 确保基础UI渲染正常
  - 确保所有测试通过，如有问题请向用户提问

- [ ] 6. 实现"TA的橱窗"功能区域
  - [ ] 6.1 创建ShowcaseSection组件
    - 显示"TA的橱窗"标题
    - 显示橱窗内容卡片（最多3个）
    - 实现橱窗卡片布局（横向滚动或网格布局）
    - 当橱窗内容超过3个时显示"查看更多"按钮
    - 当用户没有橱窗内容时隐藏整个区域
    - _需求: 13.1, 13.2, 13.3, 13.5, 13.6_

  - [ ] 6.2 创建ShowcaseCard组件
    - 显示橱窗封面图
    - 显示橱窗标题和描述
    - 显示价格（如果是商品类型）
    - 实现点击导航到橱窗详情页面
    - _需求: 13.4_

  - [ ]* 6.3 编写橱窗显示的属性测试
    - **属性 17: 橱窗内容显示正确性**
    - **验证需求: 13.1, 13.2, 13.3, 13.5**

  - [ ]* 6.4 编写橱窗导航的属性测试
    - **属性 18: 橱窗导航正确性**
    - **验证需求: 13.4, 13.6, 13.7**

- [ ] 7. 实现内容标签栏和列表（今日头条风格）
  - [x] 7.1 创建ContentTabs组件
    - 实现"全部"、"文章"、"视频"、"微头条"、"转发"五个标签
    - 实现标签切换逻辑
    - 添加活动标签指示器（红色下划线）
    - 在标签栏右侧添加搜索图标和音频图标
    - _需求: 5.1, 5.7_

  - [x] 7.2 创建ContentList组件
    - 使用FlatList实现内容列表
    - 实现列表项渲染逻辑
    - 实现空状态显示
    - _需求: 5.8_

  - [ ]* 7.3 编写内容过滤的属性测试
    - **属性 5: 内容标签过滤正确性**
    - **验证需求: 5.2, 5.3, 5.4, 5.5, 5.6**

- [ ] 8. 实现内容卡片组件（今日头条风格）
  - [x] 8.1 创建ArticleCard组件
    - 显示文章标题
    - 显示封面图（如果有）
    - 显示文章摘要
    - 显示用户头像、用户名、发布时间
    - 显示浏览数、评论数、点赞数、分享数、收藏数
    - 实现点击导航到ArticleDetail
    - _需求: 6.1, 6.6_

  - [x] 8.2 创建VideoCard组件
    - 显示视频标题
    - 显示视频缩略图
    - 显示视频时长
    - 显示用户头像、用户名、发布时间
    - 显示浏览数、评论数、点赞数、分享数、收藏数
    - 实现点击导航到VideoDetail
    - _需求: 6.4, 6.6_

  - [x] 8.3 创建MicroPostCard组件
    - 显示微头条内容文字
    - 显示配图（如果有，支持多图）
    - 显示用户头像、用户名、发布时间
    - 显示评论数、点赞数、分享数、收藏数
    - 实现点击导航到MicroPostDetail
    - _需求: 6.4, 6.6_

  - [x] 8.4 创建RepostCard组件
    - 显示转发评论
    - 显示原内容信息（嵌套卡片）
    - 显示用户头像、用户名、发布时间
    - 显示评论数、点赞数、分享数、收藏数
    - 实现点击导航到原内容详情页面
    - _需求: 6.4, 6.6_

  - [ ]* 8.5 编写文章卡片的属性测试
    - **属性 7: 文章卡片信息完整性**
    - **验证需求: 6.1, 6.6**

  - [ ]* 8.6 编写视频卡片的属性测试
    - **属性 8: 视频卡片信息完整性**
    - **验证需求: 6.4, 6.6**

  - [ ]* 8.7 编写微头条卡片的属性测试
    - **属性 9: 微头条卡片信息完整性**
    - **验证需求: 6.4, 6.6**

  - [ ]* 8.8 编写转发卡片的属性测试
    - **属性 10: 转发卡片信息完整性**
    - **验证需求: 6.4, 6.6**

  - [ ]* 8.9 编写内容导航的属性测试
    - **属性 6: 内容卡片导航正确性**
    - **验证需求: 5.9**

- [ ] 9. 实现数据加载逻辑
  - [x] 9.1 创建API服务函数
    - 实现getUserPublicProfile函数（获取用户公开信息）
    - 实现getUserContents函数（获取用户内容列表，支持文章、视频、微头条、转发）
    - 实现getUserShowcase函数（获取用户橱窗内容）
    - 实现followUser函数（关注/取消关注）
    - 实现checkFollowStatus函数（检查关注状态）
    - _需求: 1.3_

  - [x] 9.2 实现数据加载和状态管理
    - 使用useEffect在组件挂载时加载用户数据
    - 加载用户基本信息
    - 加载橱窗数据（如果有）
    - 实现加载状态管理（isLoading）
    - 实现错误状态管理（error）
    - 从路由参数获取userId
    - _需求: 1.3, 11.1_

  - [ ]* 9.3 编写用户ID加载的属性测试
    - **属性 1: 用户ID参数加载正确性**
    - **验证需求: 1.3**

  - [ ]* 9.4 编写错误处理的单元测试
    - 测试用户不存在的情况（404错误）
    - 测试网络错误的情况
    - 测试数据格式错误的情况
    - _需求: 1.4, 11.2_

- [x] 10. 检查点 - 确保数据加载和显示正常
  - 确保所有测试通过，如有问题请向用户提问

- [ ] 11. 实现分页加载功能
  - [x] 11.1 实现分页加载逻辑
    - 添加currentPage和hasMore状态
    - 实现onEndReached处理函数
    - 实现loadMore函数
    - 实现isLoadingMore状态管理
    - _需求: 12.1_

  - [x] 11.2 实现分页加载UI
    - 在列表底部显示加载指示器
    - 显示"没有更多内容"提示
    - 显示加载失败和重试选项
    - _需求: 12.2, 12.3, 12.4_

  - [ ]* 11.3 编写分页加载的属性测试
    - **属性 15: 分页加载连续性**
    - **验证需求: 12.1**

  - [ ]* 11.4 编写分页加载状态的属性测试
    - **属性 16: 分页加载状态正确性**
    - **验证需求: 12.2, 12.3, 12.4**

- [ ] 12. 实现分享功能
  - [ ] 12.1 创建ShareService
    - 实现generateShareLink函数
    - 实现generateQRCode函数（使用qrcode库）
    - 实现shareProfile函数（调用React Native的Share API）
    - 实现copyLinkToClipboard函数
    - _需求: 7.2, 7.3, 7.4, 7.5, 7.6_

  - [ ] 12.2 集成分享功能到Header组件
    - 实现分享按钮点击处理
    - 显示分享选项菜单（复制链接、生成二维码、分享到...）
    - 实现二维码显示Modal
    - _需求: 7.2_

  - [ ]* 12.3 编写分享链接的属性测试
    - **属性 11: 分享链接格式正确性**
    - **验证需求: 7.3, 7.6**

  - [ ]* 12.4 编写二维码生成的属性测试
    - **属性 12: 二维码内容正确性**
    - **验证需求: 7.4**

- [ ] 13. 实现统计数据交互
  - [ ] 13.1 实现统计数据点击处理
    - 实现关注数点击导航到关注列表
    - 实现粉丝数点击导航到粉丝列表
    - 实现获赞数点击显示详情对话框
    - _需求: 9.1, 9.2, 9.3_

  - [ ]* 13.2 编写统计数据导航的属性测试
    - **属性 13: 统计数据导航正确性**
    - **验证需求: 9.1, 9.2, 9.3**

- [ ] 14. 实现加载和错误状态UI
  - [ ] 14.1 创建LoadingState组件
    - 显示加载指示器
    - 添加加载文本提示
    - _需求: 11.1_

  - [ ] 14.2 创建ErrorState组件
    - 显示错误图标和消息
    - 实现重试按钮
    - 处理不同类型的错误（网络错误、404等）
    - _需求: 11.2, 11.3, 11.4_

  - [ ]* 14.3 编写加载状态的属性测试
    - **属性 14: 加载状态UI一致性**
    - **验证需求: 11.1, 11.2, 11.3**

- [ ] 15. 添加路由配置
  - [ ] 15.1 在App.js中添加PublicProfileScreen路由
    - 配置路由名称为"PublicProfile"
    - 配置路由参数（userId）
    - 确保可以通过深度链接访问
    - _需求: 1.2_

  - [ ]* 15.2 编写路由导航的单元测试
    - 测试通过userId参数导航到PublicProfileScreen
    - 测试深度链接解析
    - _需求: 1.2_

- [ ] 16. 样式和响应式布局（今日头条风格）
  - [ ] 16.1 创建样式表
    - 定义所有组件的样式（参考今日头条设计）
    - 关注按钮：红色背景（#FF4D4F），白色文字，圆角
    - 发私信按钮：白色背景，灰色边框，灰色文字，圆角
    - 标签栏：活动标签红色下划线
    - 头像：右上角圆形，带认证角标
    - 使用SafeAreaView确保内容不被遮挡
    - 实现响应式布局（适配不同屏幕尺寸）
    - _需求: 10.1, 10.4_

  - [ ]* 16.2 编写样式的单元测试
    - 测试不同屏幕尺寸下的布局
    - 测试SafeAreaView的使用
    - _需求: 10.1, 10.4_

- [ ] 17. 国际化支持
  - [ ] 17.1 添加翻译文本
    - 在i18n配置中添加所有UI文本的翻译
    - 使用useTranslation hook获取翻译函数
    - 替换所有硬编码文本为翻译键
    - _需求: 所有UI文本_

  - [ ]* 17.2 编写国际化的单元测试
    - 测试不同语言下的文本显示
    - 测试语言切换
    - _需求: 所有UI文本_

- [ ] 18. 最终检查点 - 集成测试
  - 确保所有测试通过，如有问题请向用户提问

## 注意事项

- 任务标记为 `*` 的是可选任务，可以跳过以加快MVP开发
- 每个任务都引用了具体的需求编号以便追溯
- 检查点确保增量验证
- 属性测试验证通用正确性属性
- 单元测试验证特定示例和边缘情况
