# 实施计划: i18n-completion

## 概述

本实施计划将系统化地为React Native问答社区应用的所有未国际化页面和组件添加多语言支持。实施将分阶段进行，优先处理核心功能页面，然后是次要页面，最后是组件。每个阶段都包括翻译文件更新、代码修改和测试。

## 任务

- [x] 1. 准备翻译文件基础结构
  - 在zh.json和en.json中创建screens和components命名空间
  - 整理现有common命名空间，确保包含所有通用文本
  - 创建翻译键映射文档模板
  - _需求: 3.1, 3.2, 3.3, 4.4_

- [ ] 2. 国际化问题相关页面
  - [x] 2.1 国际化QuestionDetailScreen
    - 添加翻译键到zh.json和en.json（tabs、actions、stats、messages等）
    - 在组件中导入useTranslation hook
    - 替换所有硬编码文本为t()调用
    - 处理动态文本（时间格式、数字格式）
    - _需求: 1.1, 5.1, 5.2, 5.5, 7.1, 7.2_
  
  - [x] 2.2 国际化QuestionActivityListScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.1, 5.1, 5.2_
  
  - [x] 2.3 国际化QuestionRankingScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.1, 5.1, 5.2_
  
  - [x] 2.4 国际化QuestionBankScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.1, 5.1, 5.2_
  
  - [x] 2.5 国际化QuestionTeamsScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.1, 5.1, 5.2_

- [ ]* 2.6 为问题相关页面编写单元测试
  - 测试翻译键存在性
  - 测试组件在不同语言下的渲染
  - _需求: 1.1_

- [ ] 3. 国际化活动相关页面
  - [x] 3.1 国际化ActivityScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理日期时间格式
    - _需求: 1.2, 5.1, 5.2, 7.1_
  
  - [x] 3.2 国际化CreateActivityScreen
    - 添加翻译键到zh.json和en.json（表单标签、占位符、验证消息）
    - 替换硬编码文本为t()调用
    - _需求: 1.2, 5.1, 5.2, 8.4, 9.1_

- [ ]* 3.3 为活动相关页面编写单元测试
  - 测试表单验证消息的国际化
  - 测试日期时间格式化
  - _需求: 1.2, 7.1_

- [x] 4. 国际化考试相关页面
  - [x] 4.1 国际化WisdomIndexScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.3, 5.1, 5.2_
  
  - [x] 4.2 国际化WisdomExamScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.3, 5.1, 5.2_
  
  - [x] 4.3 国际化ExamDetailScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理分数和百分比格式
    - _需求: 1.3, 5.1, 5.2, 7.4_
  
  - [x] 4.4 国际化ExamHistoryScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理日期格式和空状态
    - _需求: 1.3, 5.1, 5.2, 7.1, 9.2_

- [ ]* 4.5 为考试相关页面编写单元测试
  - 测试分数和百分比格式化
  - 测试空状态提示
  - _需求: 1.3, 7.4, 9.2_

- [x] 5. 检查点 - 确保核心页面国际化完成
  - 确保所有测试通过，如有问题请询问用户。

- [x] 6. 国际化用户相关页面
  - [x] 6.1 国际化SettingsScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.4, 5.1, 5.2_
  
  - [x] 6.2 国际化ProfileScreen（如果尚未国际化）
    - 检查是否已国际化，如未国际化则添加翻译
    - _需求: 1.4, 5.1, 5.2_
  
  - [x] 6.3 国际化InviteAnswerScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.4, 5.1, 5.2_
  
  - [x] 6.4 国际化InviteTeamMemberScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.4, 5.1, 5.2_

- [ ]* 6.5 为用户相关页面编写单元测试
  - 测试设置页面的国际化
  - 测试邀请功能的国际化
  - _需求: 1.4_

- [ ] 7. 国际化其他功能页面（第一批）
  - [x] 7.1 国际化SearchScreen
    - 添加翻译键到zh.json和en.json（占位符、空状态、搜索历史）
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2, 9.1, 9.3_
  
  - [x] 7.2 国际化ReportScreen
    - 添加翻译键到zh.json和en.json（举报原因、表单标签）
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_
  
  - [x] 7.3 国际化UploadBankScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_
  
  - [x] 7.4 国际化TeamDetailScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_
  
  - [x] 7.5 国际化SupplementDetailScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_

- [ ]* 7.6 为第一批其他页面编写单元测试
  - 测试搜索功能的国际化
  - 测试举报功能的国际化
  - _需求: 1.5_

- [ ] 8. 国际化其他功能页面（第二批）
  - [x] 8.1 国际化SuperLikeHistoryScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理日期格式和空状态
    - _需求: 1.5, 5.1, 5.2, 7.1, 9.2_
  
  - [x] 8.2 国际化SuperLikePurchaseScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理货币格式
    - _需求: 1.5, 5.1, 5.2, 7.3_
  
  - [x] 8.3 国际化MessagesScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理时间格式和空状态
    - _需求: 1.5, 5.1, 5.2, 7.1, 9.2_
  
  - [x] 8.4 国际化GroupChatScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理时间格式
    - _需求: 1.5, 5.1, 5.2, 7.1_
  
  - [x] 8.5 国际化HotListScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_

- [ ]* 8.6 为第二批其他页面编写单元测试
  - 测试超级赞功能的国际化
  - 测试消息功能的国际化
  - _需求: 1.5_

- [ ] 9. 国际化其他功能页面（第三批）
  - [x] 9.1 国际化IncomeRankingScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理货币格式
    - _需求: 1.5, 5.1, 5.2, 7.3_
  
  - [x] 9.2 国际化ContributorsScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_
  
  - [x] 9.3 国际化AddRewardScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理货币格式和表单验证
    - _需求: 1.5, 5.1, 5.2, 7.3, 8.4_
  
  - [x] 9.4 国际化AnswerDetailScreen
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 1.5, 5.1, 5.2_

- [ ]* 9.5 为第三批其他页面编写单元测试
  - 测试收入排名的国际化
  - 测试悬赏功能的国际化
  - _需求: 1.5_

- [x] 10. 检查点 - 确保所有页面国际化完成
  - 确保所有测试通过，如有问题请询问用户。

- [ ] 11. 国际化核心组件
  - [x] 11.1 国际化AnswerListItem组件
    - 添加翻译键到zh.json和en.json（adopted、时间格式）
    - 替换硬编码文本为t()调用
    - 创建formatTime辅助函数使用翻译
    - _需求: 2.1, 5.1, 5.2, 7.1_
  
  - [x] 11.2 国际化QuestionListItem组件
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 2.2, 5.1, 5.2_
  
  - [x] 11.3 国际化FavoriteListItem组件
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 2.3, 5.1, 5.2_
  
  - [x] 11.4 国际化SuperLikeBalance组件
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 2.4, 5.1, 5.2_
  
  - [x] 11.5 国际化UseSuperLikeButton组件
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - 处理确认对话框和Toast消息
    - _需求: 2.5, 5.1, 5.2, 8.2, 8.3_
  
  - [x] 11.6 国际化IdentitySelector组件
    - 添加翻译键到zh.json和en.json
    - 替换硬编码文本为t()调用
    - _需求: 2.6, 5.1, 5.2_

- [ ]* 11.7 为组件编写单元测试
  - 测试组件在不同语言下的渲染
  - 测试时间格式化函数
  - 测试对话框和Toast消息
  - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [x] 12. 创建时间格式化辅助函数
  - 创建src/utils/timeFormatter.js
  - 实现formatTime函数，支持国际化
  - 实现formatDate函数，支持国际化
  - 在相关组件中使用辅助函数
  - _需求: 7.1_

- [ ]* 12.1 为时间格式化函数编写单元测试
  - 测试中文时间格式
  - 测试英文时间格式
  - 测试边缘情况（刚刚、昨天等）
  - _需求: 7.1_

- [x] 13. 创建数字格式化辅助函数
  - 创建src/utils/numberFormatter.js
  - 实现formatNumber函数（如25.6万 / 25.6K）
  - 实现formatCurrency函数
  - 实现formatPercent函数
  - 在相关组件中使用辅助函数
  - _需求: 7.2, 7.3, 7.4_

- [ ]* 13.1 为数字格式化函数编写单元测试
  - 测试中文数字格式（万、亿）
  - 测试英文数字格式（K、M）
  - 测试货币格式
  - 测试百分比格式
  - _需求: 7.2, 7.3, 7.4_

- [x] 14. 验证翻译文件完整性
  - 编写脚本验证zh.json和en.json的键结构一致
  - 验证所有翻译键都有对应的值
  - 验证没有重复的翻译键
  - 生成翻译键使用报告
  - _需求: 4.1, 4.2, 4.4_

- [ ]* 14.1 编写属性测试验证翻译文件
  - **属性 2: 翻译键结构一致性**
  - **验证: 需求 4.4**
  - 使用fast-check生成随机翻译键路径
  - 验证zh.json和en.json中都存在该路径
  
- [ ]* 14.2 编写属性测试验证翻译键命名
  - **属性 7: 翻译键命名规范性**
  - **验证: 需求 3.1, 3.2, 3.3, 3.4**
  - 验证所有翻译键使用驼峰命名法
  - 验证翻译键按模块组织

- [ ]* 14.3 编写属性测试验证翻译文本非空
  - **属性 1: 翻译键存在性**
  - **验证: 需求 4.1, 4.2, 4.4**
  - 验证所有翻译键的值非空
  - 验证所有翻译键在两个文件中都存在

- [ ] 15. 集成测试和验证
  - [x] 15.1 测试语言自动检测
    - 模拟不同的系统语言设置
    - 验证应用显示正确的语言
    - _需求: 6.1, 6.2, 6.3, 6.4_
  
  - [x] 15.2 测试所有页面的国际化
    - 遍历所有页面，验证无硬编码文本
    - 验证中英文切换正常
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_
  
  - [x] 15.3 测试所有组件的国际化
    - 遍历所有组件，验证无硬编码文本
    - 验证中英文切换正常
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_
  
  - [x] 15.4 测试UI布局在不同语言下的表现
    - 截图对比中英文界面
    - 验证文本长度变化不破坏布局
    - _需求: 5.5_

- [ ]* 15.5 编写集成测试
  - 测试页面导航时语言保持一致
  - 测试组件在不同语言下的交互
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [x] 16. 文档和清理
  - 更新README.md，添加国际化说明
  - 创建翻译贡献指南
  - 清理未使用的翻译键
  - 生成最终的翻译键映射文档
  - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 17. 最终检查点 - 确保所有测试通过
  - 运行所有单元测试
  - 运行所有属性测试
  - 运行所有集成测试
  - 确保所有测试通过，如有问题请询问用户。

## 注意事项

- 标记为`*`的任务是可选的，可以跳过以加快MVP开发
- 每个任务都引用了具体的需求，以确保可追溯性
- 检查点任务确保增量验证
- 属性测试验证通用正确性属性
- 单元测试验证特定示例和边缘情况
- 建议按顺序执行任务，但同类型的页面可以并行处理
